import{c as $,r as u,a as fe,g as ue,i as Xe,b as Ze,d as Fe,e as J,f as Y,h as ze,j as Qe,k as o,l as I,L as et,s as tt,I as rt,m as nt,n as st,o as ot,p as X,R as Me,q as V,t as re,u as at,v as ne,w as ct,x as it,y as lt,z as ut,A as dt,B as ft,C as mt,D as K,E as se,F as De,G as Ae,T as pt,H as me,J as pe,K as ge,M as gt,N as ht,P as vt,O as xt,Q as Oe,S as yt,U as wt,V as bt,W as ye,X as Et}from"./index-By5-T7bp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=$("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=$("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=$("ClipboardPaste",[["path",{d:"M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z",key:"1pp7kr"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10",key:"2ik1ml"}],["path",{d:"m17 10 4 4-4 4",key:"vp2hj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=$("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=$("ImageUp",[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19.5 3-3 3 3",key:"9vmjn0"}],["path",{d:"M17 22v-5.5",key:"1aa6fl"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=$("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),_e=u.createContext({value:{},setValue:()=>{},errors:{},setErrors:()=>{},errorMode:"touched",setErrorMode:()=>{},isValid:!0,touched:{},setTouched:()=>{},resetForm:()=>{},hasChange:!1,refreshValue:()=>{}}),Nt=e=>e?(e.startsWith("536")||e.startsWith("535"))&&e.length===10:!0,Tt=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,G={required:e=>e instanceof Array?e.length>0:!Ze(e),email:e=>Tt.test(e),phone:e=>Nt(e),equal:(e,t)=>e===t},kt=e=>{const{validations:t=[],value:n}=e,[r,s]=u.useState({}),i=a=>{const{type:h,message:d,equalField:l}=a;if(d)return d;switch(h){case"required":return"Campo requerido.";case"email":return"Email inválido.";case"phone":return"Teléfono inválido.";case"equal":return l?`El campo debe ser ${l.toString()}.`:"<unknown error>";case"custom":return"Campo inválido.";default:return"<unknown error>"}},c=async()=>{const a=async d=>{const{field:l,type:g,equalField:v,customCb:m}=d,x=i(d),f=ue(n,l),y=R=>{s(b=>{let p={...b,[l]:R};return p=Fe(p),p})};if(g==="required"&&!G.required(f)||g==="email"&&!G.email(f)||g==="phone"&&!G.phone(f))return y(x);if(g==="custom"){if(!m)throw new Error("customCb is required for custom validation");const R=m(f);if(R instanceof Promise)return R.then(b=>{y(b?void 0:x)});if(Xe(R)&&!R)return y(x)}if(g==="equal"){if(!v)throw new Error("equalField is required for equal validation");if(!G.equal(f,ue(n,v)))return y(x)}y(void 0)},h=fe(t).map(a);await Promise.all(h)};return u.useEffect(()=>{c()},[JSON.stringify([n,t])]),{errors:r,setErrors:s}},It=({validate:e,children:t,onChange:n,value:r,onHasChange:s})=>{const[i,c]=u.useState(r),[a,h]=u.useState({}),[d,l]=u.useState("touched"),[g,v]=u.useState(J(r));u.useEffect(()=>{c(r)},[JSON.stringify(r)]);const m=Y(e)?e({state:i}):e,{errors:x,setErrors:f}=kt({validations:m,value:i}),y=ze(Fe(x)),R=()=>d==="all"?x:d==="touched"?Object.keys(a).reduce((S,N)=>({...S,[N]:x[N]}),{}):{},b=u.useRef(r);b.current=r;const p=S=>{Y(S)?(c(S),n==null||n(S(i),{errors:x})):(c(S),n==null||n(S,{errors:x}))},C=!Qe(g,i),w=u.useRef(!1);u.useEffect(()=>{C!==w.current&&(w.current=C,s==null||s(C))},[C]);const P={value:i,hasChange:C,isValid:y,errors:R(),setErrors:f,setTouched:h,touched:a,setValue:p,setErrorMode:l,errorMode:d,resetForm:()=>{p(g),f({}),h({})},refreshValue:()=>{v(J(b.current))}};return o.jsx(_e.Provider,{value:P,children:t(P)})},Z=({className:e,label:t,error:n,children:r,labelPosition:s="top",description:i})=>{const c=(t||i)&&o.jsx("div",{className:I("flex gap-2 items-center h-7",{"ml-2":s==="right"}),children:t&&o.jsx(et,{className:I({"text-red-500":!!n}),children:t})});return o.jsxs("div",{"data-id":"FormFieldWrapper",className:I(e),children:[s==="right"&&o.jsxs("div",{className:I("flex items-center"),children:[r,c]}),s==="top"&&o.jsxs("div",{children:[c,r]}),o.jsx("div",{className:"text-red-500 text-xs text-start ml-4 mt-0.5",children:n})]})},Ft=()=>u.useContext(_e),z=e=>{const{name:t}=e,{setValue:n,value:r,errors:s,setTouched:i,setErrors:c}=Ft();return{getNestedFieldName:a=>`${t}.${a.toString()}`,error:t?s[t]:void 0,setError:a=>{t&&c(h=>{const d=J(h);return d[t]=a,d})},field:{value:t?ue(r,t):void 0,name:t,onChange:(...a)=>{n(h=>{const d=J(h);return a.forEach(l=>{l.target.name&&tt(d,l.target.name,l.target.value)}),d})},onClick:()=>{t&&i(a=>({...a,[t]:!0}))}}}},oe=u.forwardRef((e,t)=>{const{className:n,label:r,description:s,error:i,autoFocus:c,autoFocusDelay:a=0,processing:h,...d}=e,l=u.useRef(null),{field:g,error:v}=z(e);return u.useEffect(()=>{c&&setTimeout(()=>{var m;return(m=l.current)==null?void 0:m.focus()},a)},[]),o.jsx(Z,{label:r,error:i??v,description:s,className:n,children:o.jsx(rt,{ref:nt([l,t]),className:I({"ring-1 rounded-3xl ring-red-500 focus:ring-red-500":!!v}),...d,...g,value:(()=>{let m=st(g.value)?"":g.value;return h&&(m=h.pre(m)),m})(),onChange:m=>{let x=m.target.value;h&&(x=h.post(x)),g.onChange({target:{name:g.name,value:x}})}})})}),Mt="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function we(e,t){if(!e||!t)return!1;const n=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&ot(n)){let r=t;for(;r;){if(e===r)return!0;r=r.parentNode||r.host}}return!1}function W(e){return"composedPath"in e?e.composedPath()[0]:e.target}function ae(e,t){if(t==null)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return n.target!=null&&t.contains(n.target)}function Dt(e){return e.matches("html,body")}function be(e){return(e==null?void 0:e.ownerDocument)||document}function At(e){return X(e)&&e.matches(Mt)}function ce(e,t){let n=e.filter(s=>{var i;return s.parentId===t&&((i=s.context)==null?void 0:i.open)}),r=n;for(;r.length;)r=e.filter(s=>{var i;return(i=r)==null?void 0:i.some(c=>{var a;return s.parentId===c.id&&((a=s.context)==null?void 0:a.open)})}),n=n.concat(r);return n}function Ot(e){return"nativeEvent"in e}function Ee(e,t){return["mouse","pen"].includes(e)}var Vt=typeof document<"u",_t=function(){},de=Vt?u.useLayoutEffect:_t;const Lt={...Me},Ut=Lt.useInsertionEffect,$t=Ut||(e=>e());function U(e){const t=u.useRef(()=>{});return $t(()=>{t.current=e}),u.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}const qt="data-floating-ui-focusable",je="active",Re="selected",Kt={...Me};let Ce=!1,Wt=0;const Pe=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Wt++;function Bt(){const[e,t]=u.useState(()=>Ce?Pe():void 0);return de(()=>{e==null&&t(Pe())},[]),u.useEffect(()=>{Ce=!0},[]),e}const Ht=Kt.useId,Gt=Ht||Bt;function Jt(){const e=new Map;return{emit(t,n){var r;(r=e.get(t))==null||r.forEach(s=>s(n))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var r;(r=e.get(t))==null||r.delete(n)}}}const Yt=u.createContext(null),Xt=u.createContext(null),Zt=()=>{var e;return((e=u.useContext(Yt))==null?void 0:e.id)||null},Le=()=>u.useContext(Xt);function zt(e){return"data-floating-ui-"+e}function Qt(e){e.current!==-1&&(clearTimeout(e.current),e.current=-1)}function Se(e){return X(e.target)&&e.target.tagName==="BUTTON"}function er(e){return X(e.target)&&e.target.tagName==="A"}function Ne(e){return At(e)}function tr(e,t){t===void 0&&(t={});const{open:n,onOpenChange:r,dataRef:s,elements:{domReference:i}}=e,{enabled:c=!0,event:a="click",toggle:h=!0,ignoreMouse:d=!1,keyboardHandlers:l=!0,stickIfOpen:g=!0}=t,v=u.useRef(),m=u.useRef(!1),x=u.useMemo(()=>({onPointerDown(f){v.current=f.pointerType},onMouseDown(f){const y=v.current;f.button===0&&a!=="click"&&(Ee(y)&&d||(n&&h&&(!(s.current.openEvent&&g)||s.current.openEvent.type==="mousedown")?r(!1,f.nativeEvent,"click"):(f.preventDefault(),r(!0,f.nativeEvent,"click"))))},onClick(f){const y=v.current;if(a==="mousedown"&&v.current){v.current=void 0;return}Ee(y)&&d||(n&&h&&(!(s.current.openEvent&&g)||s.current.openEvent.type==="click")?r(!1,f.nativeEvent,"click"):r(!0,f.nativeEvent,"click"))},onKeyDown(f){v.current=void 0,!(f.defaultPrevented||!l||Se(f))&&(f.key===" "&&!Ne(i)&&(f.preventDefault(),m.current=!0),!er(f)&&f.key==="Enter"&&r(!(n&&h),f.nativeEvent,"click"))},onKeyUp(f){f.defaultPrevented||!l||Se(f)||Ne(i)||f.key===" "&&m.current&&(m.current=!1,r(!(n&&h),f.nativeEvent,"click"))}}),[s,i,a,d,l,r,n,g,h]);return u.useMemo(()=>c?{reference:x}:{},[c,x])}const rr={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},nr={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Te=e=>{var t,n;return{escapeKey:typeof e=="boolean"?e:(t=e==null?void 0:e.escapeKey)!=null?t:!1,outsidePress:typeof e=="boolean"?e:(n=e==null?void 0:e.outsidePress)!=null?n:!0}};function sr(e,t){t===void 0&&(t={});const{open:n,onOpenChange:r,elements:s,dataRef:i}=e,{enabled:c=!0,escapeKey:a=!0,outsidePress:h=!0,outsidePressEvent:d="pointerdown",referencePress:l=!1,referencePressEvent:g="pointerdown",ancestorScroll:v=!1,bubbles:m,capture:x}=t,f=Le(),y=U(typeof h=="function"?h:()=>!1),R=typeof h=="function"?y:h,b=u.useRef(!1),{escapeKey:p,outsidePress:C}=Te(m),{escapeKey:w,outsidePress:P}=Te(x),S=u.useRef(!1),N=u.useRef(-1),O=U(E=>{var T;if(!n||!c||!a||E.key!=="Escape"||S.current)return;const A=(T=i.current.floatingContext)==null?void 0:T.nodeId,F=f?ce(f.nodesRef.current,A):[];if(!p&&(E.stopPropagation(),F.length>0)){let j=!0;if(F.forEach(k=>{var M;if((M=k.context)!=null&&M.open&&!k.context.dataRef.current.__escapeKeyBubbles){j=!1;return}}),!j)return}r(!1,Ot(E)?E.nativeEvent:E,"escape-key")}),Q=U(E=>{var T;const A=()=>{var F;O(E),(F=W(E))==null||F.removeEventListener("keydown",A)};(T=W(E))==null||T.addEventListener("keydown",A)}),H=U(E=>{var T;const A=i.current.insideReactTree;i.current.insideReactTree=!1;const F=b.current;if(b.current=!1,d==="click"&&F||A||typeof R=="function"&&!R(E))return;const j=W(E),k="["+zt("inert")+"]",M=be(s.floating).querySelectorAll(k);let L=V(j)?j:null;for(;L&&!ne(L);){const D=ct(L);if(ne(D)||!V(D))break;L=D}if(M.length&&V(j)&&!Dt(j)&&!we(j,s.floating)&&Array.from(M).every(D=>!we(L,D)))return;if(X(j)&&te){const D=ne(j),_=it(j),q=/auto|scroll/,Ke=D||q.test(_.overflowX),We=D||q.test(_.overflowY),Be=Ke&&j.clientWidth>0&&j.scrollWidth>j.clientWidth,He=We&&j.clientHeight>0&&j.scrollHeight>j.clientHeight,Ge=_.direction==="rtl",Je=He&&(Ge?E.offsetX<=j.offsetWidth-j.clientWidth:E.offsetX>j.clientWidth),Ye=Be&&E.offsetY>j.clientHeight;if(Je||Ye)return}const ve=(T=i.current.floatingContext)==null?void 0:T.nodeId,qe=f&&ce(f.nodesRef.current,ve).some(D=>{var _;return ae(E,(_=D.context)==null?void 0:_.elements.floating)});if(ae(E,s.floating)||ae(E,s.domReference)||qe)return;const xe=f?ce(f.nodesRef.current,ve):[];if(xe.length>0){let D=!0;if(xe.forEach(_=>{var q;if((q=_.context)!=null&&q.open&&!_.context.dataRef.current.__outsidePressBubbles){D=!1;return}}),!D)return}r(!1,E,"outside-press")}),ee=U(E=>{var T;const A=()=>{var F;H(E),(F=W(E))==null||F.removeEventListener(d,A)};(T=W(E))==null||T.addEventListener(d,A)});u.useEffect(()=>{if(!n||!c)return;i.current.__escapeKeyBubbles=p,i.current.__outsidePressBubbles=C;let E=-1;function T(M){r(!1,M,"ancestor-scroll")}function A(){window.clearTimeout(E),S.current=!0}function F(){E=window.setTimeout(()=>{S.current=!1},lt()?5:0)}const j=be(s.floating);a&&(j.addEventListener("keydown",w?Q:O,w),j.addEventListener("compositionstart",A),j.addEventListener("compositionend",F)),R&&j.addEventListener(d,P?ee:H,P);let k=[];return v&&(V(s.domReference)&&(k=re(s.domReference)),V(s.floating)&&(k=k.concat(re(s.floating))),!V(s.reference)&&s.reference&&s.reference.contextElement&&(k=k.concat(re(s.reference.contextElement)))),k=k.filter(M=>{var L;return M!==((L=j.defaultView)==null?void 0:L.visualViewport)}),k.forEach(M=>{M.addEventListener("scroll",T,{passive:!0})}),()=>{a&&(j.removeEventListener("keydown",w?Q:O,w),j.removeEventListener("compositionstart",A),j.removeEventListener("compositionend",F)),R&&j.removeEventListener(d,P?ee:H,P),k.forEach(M=>{M.removeEventListener("scroll",T)}),window.clearTimeout(E)}},[i,s,a,R,d,n,r,v,c,p,C,O,w,Q,H,P,ee]),u.useEffect(()=>{i.current.insideReactTree=!1},[i,R,d]);const he=u.useMemo(()=>({onKeyDown:O,...l&&{[rr[g]]:E=>{r(!1,E.nativeEvent,"reference-press")},...g!=="click"&&{onClick(E){r(!1,E.nativeEvent,"reference-press")}}}}),[O,r,l,g]),te=u.useMemo(()=>({onKeyDown:O,onMouseDown(){b.current=!0},onMouseUp(){b.current=!0},[nr[d]]:()=>{i.current.insideReactTree=!0},onBlurCapture(){f||(Qt(N),i.current.insideReactTree=!0,N.current=window.setTimeout(()=>{i.current.insideReactTree=!1}))}}),[O,d,i,f]);return u.useMemo(()=>c?{reference:he,floating:te}:{},[c,he,te])}function or(e){const{open:t=!1,onOpenChange:n,elements:r}=e,s=Gt(),i=u.useRef({}),[c]=u.useState(()=>Jt()),a=Zt()!=null,[h,d]=u.useState(r.reference),l=U((m,x,f)=>{i.current.openEvent=m?x:void 0,c.emit("openchange",{open:m,event:x,reason:f,nested:a}),n==null||n(m,x,f)}),g=u.useMemo(()=>({setPositionReference:d}),[]),v=u.useMemo(()=>({reference:h||r.reference||null,floating:r.floating||null,domReference:r.reference}),[h,r.reference,r.floating]);return u.useMemo(()=>({dataRef:i,open:t,onOpenChange:l,elements:v,events:c,floatingId:s,refs:g}),[t,l,v,c,s,g])}function ar(e){e===void 0&&(e={});const{nodeId:t}=e,n=or({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||n,s=r.elements,[i,c]=u.useState(null),[a,h]=u.useState(null),l=(s==null?void 0:s.domReference)||i,g=u.useRef(null),v=Le();de(()=>{l&&(g.current=l)},[l]);const m=at({...e,elements:{...s,...a&&{reference:a}}}),x=u.useCallback(p=>{const C=V(p)?{getBoundingClientRect:()=>p.getBoundingClientRect(),getClientRects:()=>p.getClientRects(),contextElement:p}:p;h(C),m.refs.setReference(C)},[m.refs]),f=u.useCallback(p=>{(V(p)||p===null)&&(g.current=p,c(p)),(V(m.refs.reference.current)||m.refs.reference.current===null||p!==null&&!V(p))&&m.refs.setReference(p)},[m.refs]),y=u.useMemo(()=>({...m.refs,setReference:f,setPositionReference:x,domReference:g}),[m.refs,f,x]),R=u.useMemo(()=>({...m.elements,domReference:l}),[m.elements,l]),b=u.useMemo(()=>({...m,...r,refs:y,elements:R,nodeId:t}),[m,y,R,t,r]);return de(()=>{r.dataRef.current.floatingContext=b;const p=v==null?void 0:v.nodesRef.current.find(C=>C.id===t);p&&(p.context=b)}),u.useMemo(()=>({...m,context:b,refs:y,elements:R}),[m,y,R,b])}function ie(e,t,n){const r=new Map,s=n==="item";let i=e;if(s&&e){const{[je]:c,[Re]:a,...h}=e;i=h}return{...n==="floating"&&{tabIndex:-1,[qt]:""},...i,...t.map(c=>{const a=c?c[n]:null;return typeof a=="function"?e?a(e):null:a}).concat(e).reduce((c,a)=>(a&&Object.entries(a).forEach(h=>{let[d,l]=h;if(!(s&&[je,Re].includes(d)))if(d.indexOf("on")===0){if(r.has(d)||r.set(d,[]),typeof l=="function"){var g;(g=r.get(d))==null||g.push(l),c[d]=function(){for(var v,m=arguments.length,x=new Array(m),f=0;f<m;f++)x[f]=arguments[f];return(v=r.get(d))==null?void 0:v.map(y=>y(...x)).find(y=>y!==void 0)}}}else c[d]=l}),c),{})}}function cr(e){e===void 0&&(e=[]);const t=e.map(a=>a==null?void 0:a.reference),n=e.map(a=>a==null?void 0:a.floating),r=e.map(a=>a==null?void 0:a.item),s=u.useCallback(a=>ie(a,e,"reference"),t),i=u.useCallback(a=>ie(a,e,"floating"),n),c=u.useCallback(a=>ie(a,e,"item"),r);return u.useMemo(()=>({getReferenceProps:s,getFloatingProps:i,getItemProps:c}),[s,i,c])}const ir=({children:e,open:t,onOpen:n,disabled:r})=>{const[s,i]=u.useState(t??!1),c=ar({open:s,onOpenChange:m=>{i(m),n==null||n(m)},middleware:[ut(8),dt(),ft()]}),{context:a,update:h}=c,d=tr(a,{enabled:!r}),l=sr(a,{ancestorScroll:!0}),g=cr([d,l]);return e({...c,...g,isOpen:s,toggle:m=>{r||(i(m),n==null||n(m),h())}})},lr=({children:e,content:t,open:n,onOpen:r,disabled:s,className:i})=>o.jsx(ir,{open:n,onOpen:r,disabled:s,children:({getReferenceProps:c,getFloatingProps:a,refs:h,isOpen:d,floatingStyles:l,toggle:g})=>o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:h.setReference,...c(),className:I("w-fit",{"cursor-not-allowed":s,"cursor-pointer":!s},i),children:e}),d&&o.jsx("div",{ref:h.setFloating,style:{...l,zIndex:1e3},...a(),children:Y(t)?t({onClose:()=>g(!1)}):t})]})}),ur=({contentFullWidth:e,...t})=>e?o.jsx(dr,{...t}):o.jsx(Ue,{...t}),Ue=({children:e,...t})=>o.jsx(lr,{...t,children:e}),dr=({children:e,content:t,...n})=>{const[r,s]=u.useState(),i=c=>o.jsx("div",{style:{width:r},children:c});return o.jsx(Ue,{content:Y(t)?c=>i(t(c)):i(t),...n,children:o.jsx("div",{className:"w-full cursor-pointer",ref:c=>{const a=c==null?void 0:c.offsetWidth;mt(a)&&a!==r&&s(a)},children:e})})},le=e=>{const{items:t,renderOption:n,renderValue:r,label:s,className:i,optionToValue:c,placeholder:a,multi:h,disabled:d,description:l,onChange:g}=e,[v,m]=u.useState(),{field:x,error:f}=z(e),{value:y=h?[]:null}=x;u.useEffect(()=>{let b=y;c&&(K(y)?b=y.map(p=>t.find(C=>c(C)===p)):b=t.find(p=>c(p)===y)),m(b)},[JSON.stringify([y])]);const R=b=>{if(K(b)){const p=Ae(b);m(p);const C=c?p.map(c):p;g==null||g(C),x.onChange({target:{name:x.name,value:C}})}else{const p=b;m(p);const C=c?c(p):p;g==null||g(C),x.onChange({target:{name:x.name,value:C}})}};return o.jsx(Z,{label:s,error:f,className:i,description:l,children:o.jsx(ur,{disabled:d,contentFullWidth:!0,content:({onClose:b})=>o.jsx("div",{className:"overflow-y-auto max-h-[20rem] bg-white rounded-md",children:t.map((p,C)=>{const w=K(v)?v.find(P=>se(P,p)):se(v,p);return o.jsx("div",{className:I("text-gray-900 relative select-none cursor-pointer pl-2 pr-4 py-2 my-1 rounded-sm",{"bg-gray-200":w}),onClick:()=>{K(v)?R(w?De(v,v.findIndex(P=>se(P,p))):[...v,p]):w||(R(w?void 0:p),b())},children:o.jsxs("div",{className:"flex items-center ml-2 truncate",children:[n(p),o.jsx(jt,{className:I("ml-auto",{"text-primary":w,"text-transparent":!w})})]})},C)})}),className:"w-full",children:o.jsxs("div",{className:I("relative rounded-md py-3 pl-3 pr-10 text-left text-gray-900 ring-1 ring-gray-200",{"bg-white":!d,"bg-gray-200":d}),children:[a&&!v&&o.jsx("span",{className:"text-gray-400 absolute inset-y-0 left-0 flex items-center pl-4",children:a}),o.jsx("div",{className:"flex gap-1 items-center h-6",children:v&&(K(v)?v.map((b,p)=>o.jsx(u.Fragment,{children:r(b)},p)):r(v))}),o.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 ml-3 flex items-center pr-2",children:o.jsx(Rt,{className:"size-4","aria-hidden":"true"})})]})})})},fr=u.forwardRef((e,t)=>{const{className:n,label:r,textAreaClassName:s,description:i,...c}=e,{field:a,error:h}=z(e);return o.jsx(Z,{label:r,error:h,className:n,description:i,children:o.jsx(pt,{ref:t,className:I({"ring-1 rounded-md ring-red-500 focus:ring-red-500":!!h},s),...c,...a})})}),mr=()=>({adminAddOneProduct:me({fetch:async e=>(await pe({method:"post",url:ge({path:"/admin/products"}),data:e})).data})});var B=(e=>(e.MLC="MLC",e.CUP="CUP",e.USD="USD",e))(B||{});const pr=()=>({adminUpdateOneProduct:me({fetch:async({productSlug:e,update:t})=>(await pe({method:"put",url:ge({path:"/admin/products/:productSlug",urlParams:{productSlug:e}}),data:t})).data})}),gr=({onChange:e,children:t,error:n,className:r})=>o.jsx("div",{className:I("min-h-80 border-2 border-dashed border-gray-900/25 rounded-lg hover:border-gray-900/80",{"ring-1 rounded-md ring-red-500 focus:ring-red-500":n},r),onDragOver:s=>{s.preventDefault()},onDrop:s=>{s.preventDefault();const i=Array.from(s.dataTransfer.files);e==null||e(i)},children:t}),$e=({children:e,svg:t,onClick:n})=>o.jsxs("span",{className:I("relative cursor-pointer rounded-md bg-white font-semibold text-gray-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-gray-600 focus-within:ring-offset-2 hover:text-gray-500"),onClick:n,children:[o.jsx(t,{className:"text-gray-400 size-7 inline mr-1 my-0.5"}),e]}),hr=u.forwardRef((e,t)=>{const{onChange:n,field:r,...s}=e;return o.jsx($e,{svg:Pt,onClick:()=>{},children:o.jsxs("label",{htmlFor:r.name,className:I("relative cursor-pointer rounded-md bg-white font-semibold focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2"),children:[o.jsx("span",{children:"Seleccione imagen en su galería"}),o.jsx("input",{ref:t,type:"file",className:"sr-only",accept:"image/*",...s,...r,id:r.name,value:"",onChange:i=>{var c;n==null||n((c=i.target.files)==null?void 0:c[0])}})]})})}),vr=({onChange:e})=>{const t=async()=>{try{if(!navigator.clipboard||!navigator.clipboard.read){alert("Clipboard access not supported in this browser.");return}const n=await navigator.clipboard.read();for(const r of n)for(const s of r.types)if(s.startsWith("image/")){const i=await r.getType(s),c=gt(i,"clipboard-image.png");e==null||e(c);return}alert("No image found in clipboard.")}catch(n){console.error("Failed to read clipboard:",n),alert("Error accessing clipboard.")}};return o.jsx($e,{onClick:t,svg:Ct,children:"Pegar desde portapapeles"})},xr=({images:e,selectedIndex:t,onClickOnImage:n})=>o.jsx("div",{className:"flex items-center justify-start gap-2 mb-1 w-full overflow-x-auto",children:e==null?void 0:e.map((r,s)=>{const i=s===t,c=()=>r?o.jsx("img",{src:ht(r),className:"object-cover h-full w-full"}):o.jsxs("div",{className:"relative h-full w-full text-gray-500",children:[o.jsx(Ve,{className:"h-full w-full"},s),o.jsx(vt,{className:"h-4 w-4 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-gray-600 font-bold"})]});return o.jsx("div",{className:I("size-10 cursor-pointer flex-shrink-0",{"border-gray-700 border-2 rounded-md p-0.5":i,"border-gray-200 border-2 rounded-md p-0.5":!i}),onClick:()=>n==null?void 0:n(s),children:c()},s)})}),ke=e=>[...e,void 0],yr=e=>fe(e),Ie=e=>Ae(e,t=>!!(t!=null&&t.src)),wr=u.forwardRef((e,t)=>{const{className:n,label:r,multi:s,max:i,...c}=e,{field:a,error:h}=z(e),{value:d}=a,[l,g]=u.useState([]),[v,m]=u.useState([void 0]),[x,f]=u.useState(0),y=u.useMemo(()=>{const w=v[x];if(w)return w},[x,v]);u.useEffect(()=>{if(d!==l){const w=s?d:[d];g(w);const P=ke(w);m(P)}},[d,i]);const R=w=>{a.onClick(),s?a.onChange({target:{name:a.name,value:w}}):a.onChange({target:{name:a.name,value:w[0]}})},b=async()=>{const w=De(v,x);f(x?x-1:0),m(w);const P=Ie(w);g(P),R(P)},p=async w=>{const P=fe(w);if(!P.length)return;const S=await Promise.all(P.map(xt));let N=[...v];N=yr(N),N=[...N,...S],N=ke(N),f(s?N.length-1:0),m(N);const O=Ie(N);g(O),R(O)},C=()=>y?o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("div",{className:"flex items-center gap-2 justify-end w-full p-2",children:o.jsx(Oe,{variant:"outline",onClick:()=>{b()},children:o.jsx(St,{className:"w-4 h-4"})})}),o.jsx(yt,{image:y,className:"object-contain px-2 pb-2"})]}):o.jsx("div",{className:"flex justify-center items-center text-center relative h-full",children:o.jsxs("div",{className:"py-10",children:[o.jsxs("div",{children:[o.jsx(Ve,{className:"mx-auto h-12 w-12 text-gray-300"}),o.jsx("p",{className:"text-xs leading-5 text-gray-600",children:"PNG, JPG, GIF hasta 5MB"})]}),o.jsxs("ol",{className:"mt-2 text-sm leading-6 text-gray-600",children:[o.jsx("li",{children:o.jsx(hr,{field:a,ref:t,...c,onChange:w=>p([w])})}),o.jsx("li",{children:o.jsx(vr,{onChange:w=>p([w])})})]})]})});return o.jsxs(Z,{label:r,error:h,className:n,children:[s&&o.jsx(xr,{images:v,selectedIndex:x,onClickOnImage:f}),o.jsx(gr,{onChange:async w=>{const P=w.map(S=>p([S]));await Promise.all(P)},error:!!h,className:"relative",children:C()})]})}),br=()=>({adminAddProductImage:me({fetch:async({image:e})=>{if(e.src instanceof File){const t=new FormData;t.append("upload",e.src);const n=await pe({method:"post",url:ge({path:"/admin/images/products"}),data:t,headers:{"Content-Type":"multipart/form-data"}});return{...e,src:n.data.imageSrc}}else return e}})}),jr=({product:e,onRefresh:t})=>{var a;const{adminAddOneProduct:n}=mr(),{adminUpdateOneProduct:r}=pr(),{adminAddProductImage:s}=br(),i=async h=>new Promise((d,l)=>{s.fetch({image:h},{onAfterSuccess:g=>{d(g)},onAfterFailed:()=>{l()}})}),{onClose:c}=wt();return o.jsx(It,{value:{name:"",currency:B.USD,description:"",price:0,inStock:!0,categoryType:bt.TIRE,details:"",image:(a=e==null?void 0:e.images)==null?void 0:a[0],specs:{},...e||{}},children:({value:h})=>{const d=ye.find(({type:l})=>h.categoryType===l);return o.jsxs("form",{className:"space-y-4",children:[o.jsx(oe,{label:"Nombre del Producto",name:"name"}),o.jsx(fr,{label:"Descripción",name:"description"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsx(oe,{label:"Precio",name:"price",type:"number"}),o.jsx(le,{name:"currency",label:"Moneda",items:[{value:B.CUP},{value:B.MLC},{value:B.USD}],renderOption:({value:l})=>l,renderValue:({value:l})=>l,optionToValue:({value:l})=>l}),o.jsx(le,{items:[{label:"En Stock",value:!0},{label:"Agotado",value:!1}],label:"Disponibilidad",renderOption:({label:l})=>l,renderValue:({label:l})=>l,optionToValue:({value:l})=>l,name:"inStock"})]}),o.jsx(le,{items:ye,label:"Categoría",renderOption:({name:l})=>l,renderValue:({name:l})=>l,optionToValue:({type:l})=>l,name:"categoryType"}),(d==null?void 0:d.specsFields.length)&&o.jsxs("div",{className:"bg-gray-100 rounded-md px-2 py-3",children:[o.jsx("p",{className:"mb-2",children:"Detalles de las categorías"}),o.jsx("div",{className:"grid grid-cols-2 gap-4 ",children:d==null?void 0:d.specsFields.map(({field:l,label:g},v)=>o.jsx(oe,{label:g,name:`specs.${l}`},v))})]}),o.jsx(wr,{label:"Imágen",name:"image"}),o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(Et,{children:"Cancelar"}),o.jsxs(Oe,{type:"button",onClick:async()=>{const{currency:l,name:g,price:v,description:m,details:x,image:f,inStock:y,categoryType:R,specs:b}=h,p=f?await i(f):void 0;e?r.fetch({productSlug:e.productSlug,update:{currency:l,name:g,price:v,description:m,details:x,images:p?[p]:[],inStock:y,categoryType:R,specs:b}},{onAfterSuccess:()=>{t(),c()}}):n.fetch({currency:l,name:g,price:v,description:m,details:x,images:p?[p]:[],inStock:y,categoryType:R,specs:b},{onAfterSuccess:()=>{t(),c()}})},children:[e?"Actualizar":"Crear"," Producto"]})]})]})}})};export{jr as default};
